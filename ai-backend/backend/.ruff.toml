line-length = 120
cache-dir = ".ruff_cache"
target-version = "py310"
# ğŸš¨ å…³é”®ä¿®å¤ï¼šç¦ç”¨å±é™©çš„å…¨å±€unsafe-fixes
unsafe-fixes = false
show-fixes = true

[lint]
select = [
    "E",
    "F",
    "I",
    "TC",
    # W
    "W505",
    # PT
    "PT018",
    # SIM
    "SIM101",
    "SIM114",
    # PGH
    "PGH004",
    # PL
    "PLE1142",
    # RUF
    "RUF100",
    # UP
    "UP007"
]
# ğŸš¨ å…³é”®ä¿®å¤ï¼šç¦ç”¨ä¸ç¨³å®šçš„previewç‰¹æ€§
preview = false
ignore = [
    "FURB101",
    "E501",     # line too long (ç”±formatterå¤„ç†)
    "E712",     # ğŸš¨ å…³é”®ï¼šé¿å…å°† == False/True è½¬æ¢ä¸º not/bool()ï¼ŒSQLAlchemyéœ€è¦æ˜¾å¼æ¯”è¾ƒ
    "UP007",    # é™é»˜ Optional[T] -> T | None å»ºè®®ï¼ˆä¿æŒSQLAlchemyå…¼å®¹æ€§ï¼‰
]

# ğŸ”§ æ–°å¢ï¼šæ§åˆ¶è‡ªåŠ¨ä¿®å¤çš„èŒƒå›´
fixable = [
    "F401",   # ç§»é™¤æœªä½¿ç”¨çš„å¯¼å…¥ï¼ˆå®‰å…¨ï¼‰
    "I001",   # ä¿®å¤å¯¼å…¥æ’åºï¼ˆå®‰å…¨ï¼‰
    "W292",   # æ–‡ä»¶æœ«å°¾æ¢è¡Œï¼ˆå®‰å…¨ï¼‰
    "W291",   # ç§»é™¤è¡Œå°¾ç©ºæ ¼ï¼ˆå®‰å…¨ï¼‰
]

# ğŸš« ç¦æ­¢å±é™©çš„è‡ªåŠ¨ä¿®å¤
unfixable = [
    "E712",   # æ°¸è¿œä¸è¦è‡ªåŠ¨ä¿®å¤å¸ƒå°”æ¯”è¾ƒ
    "SIM",    # ç®€åŒ–è§„åˆ™å¯èƒ½æ”¹å˜é€»è¾‘
    "UP",     # å‡çº§è§„åˆ™å¯èƒ½ç ´åå…¼å®¹æ€§
    "UP007",  # ç‰¹åˆ«ç¦æ­¢ Optional[T] -> T | None è½¬æ¢
]

[lint.flake8-pytest-style]
mark-parentheses = false
parametrize-names-type = "list"
parametrize-values-row-type = "list"
parametrize-values-type = "tuple"

[lint.flake8-unused-arguments]
ignore-variadic-names = true

# ğŸ”§ SQLAlchemyä¸“ç”¨é…ç½®ï¼šå…³é”®çš„å…¼å®¹æ€§è®¾ç½®
[lint.flake8-type-checking]
runtime-evaluated-base-classes = [
    "sqlalchemy.orm.DeclarativeBase",
    "sqlalchemy.ext.declarative.declarative_base",
    "backend.common.model.Base",  # é¡¹ç›®çš„åŸºç¡€æ¨¡å‹ç±»
    "backend.common.model.MappedBase"
]

runtime-evaluated-decorators = [
    "sqlalchemy.orm.declarative.declarative_base"
]

[lint.isort]
lines-between-types = 1
order-by-type = true
# SQLAlchemyé¡¹ç›®çš„å¯¼å…¥åˆ†ç»„
known-first-party = ["backend"]

[lint.per-file-ignores]
# APIè·¯ç”±æ–‡ä»¶ï¼šæ”¾å®½ç±»å‹æ£€æŸ¥
"**/api/v1/*.py" = ["TC"]

# ğŸ”§ SQLAlchemyæ¨¡å‹æ–‡ä»¶ï¼šé‡è¦çš„å…¼å®¹æ€§è®¾ç½®
"**/model/*.py" = [
    "TC003",   # Move stdlib import into TYPE_CHECKING block
    "TC004",   # Move import out of TYPE_CHECKING block (SQLAlchemyå…³ç³»éœ€è¦è¿è¡Œæ—¶å¯¼å…¥)
    "UP037",   # Remove quotes from type annotation (SQLAlchemyéœ€è¦å¼•ç”¨)
]

# æ¨¡å‹åˆå§‹åŒ–æ–‡ä»¶ï¼šå…è®¸æœªä½¿ç”¨çš„å¯¼å…¥
"**/model/__init__.py" = ["F401"]

# CRUDæ–‡ä»¶ï¼šSQLAlchemyç›¸å…³çš„ç±»å‹æ£€æŸ¥æ”¾å®½
"**/crud/*.py" = ["TCH001", "TCH002"]

# æµ‹è¯•æ–‡ä»¶ï¼šæ”¾å®½å¯¼å…¥é¡ºåº
"**/tests/*.py" = ["E402"]

[format]
# ğŸš¨ å…³é”®ä¿®å¤ï¼šç¦ç”¨ä¸ç¨³å®šçš„previewç‰¹æ€§
preview = false
quote-style = "double"
docstring-code-format = true
skip-magic-trailing-comma = false
# ä¿æŒä¸Blackå…¼å®¹
indent-style = "space"
